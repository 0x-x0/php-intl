language: php

php:
  - 5.5
  - 5.6

# environment variable
env:
 - FOO=bar

build:
 cache: true
 cache_dir_list:
    -  /root/.phpenv/versions/$(phpenv version-name)/lib/php/extensions/
    #- $SHIPPABLE_BUILD_DIR/node_modules

 ci:
    - php -v
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage
    #- pickle install intl
    - echo "extension=intl.so" >> $HOME/.phpenv/versions/$(phpenv version-name)/etc/php.ini
    - dirToCache=`ls $HOME/.phpenv/versions/$(phpenv version-name)/lib/php/extensions/ | grep no-debug`
    - echo $HOME/.phpenv/versions/$(phpenv version-name)/lib/php/extensions/$dirToCache
    - echo "$dirToCache" >> $HOME/version.txt
    - cat $HOME/version.txt
    - echo $SHIPPABLE_PHP_VERSION
    - docker ps -a
    - echo "$dir"
    - echo $FOO
    - echo $BAR

 post_ci:
    - echo "$dir"
    - phpv=`cat $HOME/version.txt`
    - echo $phpv
    - export versionName=$phpv
    - echo $?
    - docker ps -a
    
